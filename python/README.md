Python version of the code.

by Shuo.
