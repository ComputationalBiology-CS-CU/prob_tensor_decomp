C++ version of the code.

by Chuqiao.
